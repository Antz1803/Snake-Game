<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .myCanvas {
            width: 400px;
            height: 400px;
            border: 1px solid black;
            position: relative;
            margin: 20px auto;
        }
        .snake {
            background-color: green;
            position: absolute;
        }
        .food {
            background-color: red;
            position: absolute;
        }
        fieldset {
            border: 2px solid #007BFF; /* Blue border */
            padding: 20px;
            margin: 0 auto; /* Center the fieldset */
            width: 300px; /* Fixed width */
        }
        legend {
            font-weight: bold;
            color: #007BFF; /* Blue text */
        }
        .controls {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        label {
            margin-bottom: 5px; /* Space between label and input */
        }
        button {
            margin-top: 10px; /* Space above buttons */
            padding: 10px 15px;
            background-color: #007BFF; /* Blue background */
            color: white; /* White text */
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3; /* Darker blue on hover */
        }
    </style>
</head>
<body>

    <h1>Snake Game</h1>
    <div class="myCanvas"></div>
    
    <fieldset>
        <legend>Game Controls</legend>
        
        <div class="controls">
            <label class="score">Score: 0</label><br>
            
            <label for="difficulty">Difficulty:</label>
            <select id="difficulty">
                <option value="" disabled selected>Select Difficulty</option>
                <option value="easy">Easy</option>
                <option value="medium">Medium</option>
                <option value="hard">Hard</option>
            </select><br>

            <button id="reset" class="reset"><b>Reset Game</b></button>
            <button id="pause" style="display: block;">Pause</button>
            <button id="continue" style="display: none;">Continue</button>
        </div>
    </fieldset>

    <script>
        const canvas = document.querySelector('.myCanvas');
        const scoreLabel = document.querySelector('.score');
        const resetButton = document.getElementById('reset');
        const pauseButton = document.getElementById('pause');
        const continueButton = document.getElementById('continue');
        const difficultySelect = document.getElementById('difficulty');

        let snake, food, direction, score, highScore, gameInterval, isPaused, gameSpeed;

        function initGame() {
            if (!difficultySelect.value) {
                alert("Please select a difficulty level before starting the game.");
                return; // Prevent starting the game without selecting difficulty
            }

            snake = [{ x: 10, y: 10 }];
            food = { x: 15, y: 15 };
            direction = { x: 0, y: 0 };
            score = 0;
            highScore = localStorage.getItem('highScore') || 0;
            isPaused = false;

            setGameSpeed();
            placeFood();
            draw();
            startGame();
        }

        function setGameSpeed() {
            const difficulty = difficultySelect.value;
            if (difficulty === "easy") {
                gameSpeed = 150; // Slower speed for easy
            } else if (difficulty === "medium") {
                gameSpeed = 100; // Normal speed for medium
            } else if (difficulty === "hard") {
                gameSpeed = 50; // Faster speed for hard
            }
        }

        function draw() {
            canvas.innerHTML = '';
            
            // Draw snake
            snake.forEach(segment => {
                const segmentDiv = document.createElement('div');
                segmentDiv.classList.add('snake');
                segmentDiv.style.width = '10px';
                segmentDiv.style.height = '10px';
                segmentDiv.style.left = `${segment.x * 10}px`;
                segmentDiv.style.top = `${segment.y * 10}px`;
                canvas.appendChild(segmentDiv);
            });

            // Draw food
            const foodDiv = document.createElement('div');
            foodDiv.classList.add('food');
            foodDiv.style.width = '10px';
            foodDiv.style.height = '10px';
            foodDiv.style.left = `${food.x * 10}px`;
            foodDiv.style.top = `${food.y * 10}px`;
            canvas.appendChild(foodDiv);
            
            scoreLabel.textContent = `Score: ${score} | High Score: ${highScore}`;
        }

        function update() {
            if (isPaused) return;

            // Move snake
            const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };
            
            // Check for collision with food
            if (head.x === food.x && head.y === food.y) {
                score++;
                snake.unshift(head);
                placeFood();
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('highScore', highScore);
                }
            } else {
                snake.unshift(head);
                snake.pop();
            }

           // Check for collisions with walls or self
           if (head.x < 0 || head.x >= canvas.clientWidth / 10 || head.y < 0 || head.y >= canvas.clientHeight / 10 || isCollision(head)) {
               alert("Game Over! Your score was " + score);
               resetGame();
               return;
           }

           draw();
       }

       function isCollision(head) {
           return snake.slice(1).some(segment => segment.x === head.x && segment.y === head.y);
       }

       function placeFood() {
           food.x = Math.floor(Math.random() * (canvas.clientWidth / 10));
           food.y = Math.floor(Math.random() * (canvas.clientHeight / 10));
       }

       function startGame() {
           gameInterval = setInterval(update, gameSpeed); // Use dynamic game speed
       }

       function resetGame() {
           clearInterval(gameInterval);
           initGame(); // Reinitialize the game state
       }

       window.addEventListener('keydown', (event) => {
           switch(event.key) {
               case 'ArrowUp':
                   if (direction.y === 0) direction = { x: 0, y: -1 };
                   break;
               case 'ArrowDown':
                   if (direction.y === 0) direction = { x: 0, y: 1 };
                   break;
               case 'ArrowLeft':
                   if (direction.x === 0) direction = { x: -1, y: 0 };
                   break;
               case 'ArrowRight':
                   if (direction.x === 0) direction = { x: 1, y: 0 };
                   break;
               case 'Escape':
                   isPaused ? continueGame() : pauseGame();
                   break;
               default:
                   break;
           }
       });

       function pauseGame() {
           clearInterval(gameInterval);
           isPaused = true;
           pauseButton.style.display = 'none';
           continueButton.style.display = 'block';
       }

       function continueGame() {
           isPaused = false;
           startGame();
           pauseButton.style.display = 'block';
           continueButton.style.display = 'none';
       }

       resetButton.addEventListener('click', resetGame);
       
       pauseButton.addEventListener('click', pauseGame);
       
       continueButton.addEventListener('click', continueGame);

       // Start the game on page load
       window.onload = initGame;

   </script>
</body>
</html>